---
tags:
  - http
  - restapi
  - websockets
  - rpc
  - grpc
  - trpc
  - soap
  - graphql
  - apollo
---



## –ö–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–í —Å–∞–º–æ–º –±–∞–∑–æ–≤–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏, –º—ã –∏–º–µ–µ–º: 
1. –ö–ª–∏–µ–Ω—Ç - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä–æ–µ –∫–ª–∏–µ–Ω—Ç –æ–±—â–∞–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º
2. –°–µ—Ä–≤–µ—Ä - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –Ω–∏—Ö, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±–≤—è–∑–∫–∏

![](../../_png/Pasted%20image%2020250925195900.png)

–°–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª–Ω—è–µ—Ç (–∏–ª–∏ –Ω–µ—Ç) –¥–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—Ä–æ—Å–∏–ª —É –Ω–µ–≥–æ –∫–ª–∏–µ–Ω—Ç

![](../../_png/Pasted%20image%2020250925200128.png)

–ö–ª–∏–µ–Ω—Ç–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞–∫ –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Ç–∞–∫ –∏ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä. 

–°–µ—Ä–≤–µ—Ä - —ç—Ç–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫ –¥–∞–Ω–Ω—ã—Ö. –ö–ª–∏–µ–Ω—Ç - —ç—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –¥–∞–Ω–Ω—ã—Ö. 

![](../../_png/Pasted%20image%2020250925200237.png)



---
## HTTP

HTTP - —ç—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª —Å–µ—Ç–µ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –Ø–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º –∏ —à–∏—Ä–æ–∫–æ—Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–º. 

![](../../_png/Pasted%20image%2020250925200425.png)

HTTP —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º –≤–µ—Ä—Ö–Ω–∏–º —É—Ä–æ–≤–Ω–µ–º –º–æ–¥–µ–ª–∏ OSI

![](../../_png/Pasted%20image%2020250925200500.png)

–õ—é–±–æ–π HTTP –∑–∞–ø—Ä–æ—Å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑: 
- —Å—Ç–∞—Ä—Ç–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ - –º–µ—Ç–æ–¥–∞, url (–ø—É—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞) –∏ –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ - –¥–∞–Ω–Ω—ã–µ,  –∫–æ—Ç–æ—Ä—ã–µ –≤–ª–∏—è—é—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, —Ç–∏–ø –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ö–æ—Å—Ç –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ)
- —Ç–µ–ª–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –ø–µ–π–ª–æ–¥ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞

![](../../_png/Pasted%20image%2020250925200845.png)

–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∑–∞–ø—Ä–æ—Å–æ–≤: 
- GET - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- POST - –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö / —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞
- PUT - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞
- PATCH - —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞
- DELETE - —É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞

–°—Ç—Ä–æ–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ `HTTP/1.1 200`

–°—Ç–∞—Ç—É—Å –∫–æ–¥—ã: 
- 1xx - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- 2xx - —É—Å–ø–µ—Ö
	- 200 - —É—Å–ø–µ—Ö
	- 201 - —É—Å–ø–µ—Ö –±–µ–∑ –æ—Ç–≤–µ—Ç–∞ (–û–ö, —Å–æ–∑–¥–∞–Ω–æ)
- 3xx - —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã
- 4xx - –æ—à–∏–±–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞
	- 400 - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å
	- 404 - —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- 5xx - –æ—à–∏–±–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞
	- 500 - –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞



---
## RestAPI

API (application programming interface) - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π

![](../../_png/Pasted%20image%2020250925202738.png)

REST API - —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Å—Ç–∏–ª—å, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏ —É–¥–æ–±–Ω—ã–π API –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ HTTP (–µ–≥–æ —Å–µ–º–∞–Ω—Ç–∏–∫—É)

–ï—Å—Ç—å 6 –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤, –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –¥–æ–ª–∂–Ω—ã —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–≤–∞—Ç—å—Å—è

1. –ö–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å (client-server model) - –µ—Å—Ç—å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –¥–∞–Ω–Ω—ã—Ö;
2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (statelessness) - —Å–µ—Ä–≤–µ—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–æ–º –∏ –æ—Ç–≤–µ—Ç–æ–º. –ü—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É, –∏—Ö –æ–±—â–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∫–∞–∫ –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑;
3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (cacheability) - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏. –¢–∞–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ç–æ–ª—å–∫–æ POST –∏ GET –∑–∞–ø—Ä–æ—Å—ã - –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–ª—å–∑—è;
4. –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (uniform interface) - –≤—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –¢–∞–∫ –∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–µ–µ –Ω–∞–∑—ã–≤–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç–∏ –≤–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —á–∏—Å–ª–µ, –∞ –¥–ª—è –¥–µ–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∑–∞–ø—Ä–æ—Å–æ–≤;
  ![](../_png/Pasted%20image%2020250925204339.png)
5. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (layered system) - —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ª–æ—ë–≤ (–ø—Ä–æ–∫—Å–∏, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ);
6. –ö–æ–¥ –ø–æ¬†—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é (code on¬†demand)¬†‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.

> **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** - —ç—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è—Ö –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –¢–∞–∫–∏–º–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –º–µ—Ç–æ–¥—ã GET, PUT –∏ DELETE.

> –§–æ—Ä–º–∞—Ç–æ–º –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —è–≤–ª—è–µ—Ç—Å—è JSON, –Ω–æ —Ç–∞–∫ –∂–µ –∏–º –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ XML

–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ. –¢–∞–∫ –∂–µ –ø—Ä–∏–Ω—è—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ä–∞–º–∫–∞—Ö REST, –∫–æ–≥–¥–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥—Ä—É–≥–æ–π —Ö—ç–Ω–¥–ª–µ—Ä —Å –ø—Ä–æ–ø–∏—Å–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π:
- `access/check`
- `access/check/v2`

![](../_png/Pasted%20image%2020250927103820.png)

–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ. –°—Ä–µ–¥—Ç—Å—Ç–≤–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API –æ–±—ã—á–Ω–æ —è–≤–ª—è–µ—Ç—Å—è:
- —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è OpenAPI
- –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –µ–≥–æ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ - Swagger 



---
## SOAP

SOAP - —ç—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏. –ü—Ä–∏–º–µ–Ω–∏–º –¥–ª—è –ª—é–±–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è (SMTP, FTP, HTTP)

> –ú–æ–∂–Ω–æ –≤ –Ω–∞ –æ–¥–Ω–æ–º –±—ç–∫—ç–Ω–¥–µ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–∞–∫ REST, —Ç–∞–∫ –∏ SOAP —Ä—É—á–∫–∏

–î–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —è–∑—ã–∫ WSDL, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç:

- –∫–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ä–≤–∏—Å
- –∫–∞–∫–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–µ—Ä–≤–∏—Å (endpoint)

–ü—Ä–æ—Å—Ç–æ–π WSDL-—Ñ–∞–π–ª –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:

```XML
<definitions xmlns="http://schemas.xmlsoap.org/wsdl/"
             xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
             xmlns:xs="http://www.w3.org/2001/XMLSchema"
             xmlns:tns="http://example.com/userservice"
             targetNamespace="http://example.com/userservice">

  <!-- –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö -->
  <types>
    <xs:schema targetNamespace="http://example.com/userservice">
      <xs:element name="GetUserRequest">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="UserId" type="xs:int"/>
          </xs:sequence>
        </xs:complexType>
      </xs:element>

      <xs:element name="GetUserResponse">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="Id" type="xs:int"/>
            <xs:element name="Name" type="xs:string"/>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:schema>
  </types>

  <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
  <message name="GetUserRequest">
    <part name="parameters" element="tns:GetUserRequest"/>
  </message>
  <message name="GetUserResponse">
    <part name="parameters" element="tns:GetUserResponse"/>
  </message>

  <!-- –û–ø–µ—Ä–∞—Ü–∏–∏ -->
  <portType name="UserServicePortType">
    <operation name="GetUser">
      <input message="tns:GetUserRequest"/>
      <output message="tns:GetUserResponse"/>
    </operation>
  </portType>

  <!-- –ü—Ä–∏–≤—è–∑–∫–∞ -->
  <binding name="UserServiceBinding" type="tns:UserServicePortType">
    <soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"/>
    <operation name="GetUser">
      <soap:operation soapAction="http://example.com/userservice/GetUser"/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
    </operation>
  </binding>

  <!-- –°–µ—Ä–≤–∏—Å -->
  <service name="UserService">
    <port name="UserServicePort" binding="tns:UserServiceBinding">
      <soap:address location="http://localhost:8080/userservice"/>
    </port>
  </service>

</definitions>
```

–ï—Å–ª–∏ RESTAPI –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–Ω—ã—Ö –æ–∫–æ–Ω –¥–ª—è –æ–±—â–µ–Ω–∏—è, —Ç–æ SOAP –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–¥–Ω–æ –æ–∫–Ω–æ –¥–ª—è –æ–±—â–µ–Ω–∏—è, –≤ –∫–æ—Ç–æ—Ä–æ–µ –º—ã –ø–µ—Ä–µ–¥–∞—ë–º –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—É—é –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–¥—É—Ä—É

–ó–∞–ø—Ä–æ—Å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 3 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤: 
- Envelope - –±–ª–æ–∫ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –∞–¥—Ä–µ—Å–∞—Ü–∏–∏
- Header - —Ö—Ä–∞–Ω–∏—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∑–∞–ø—Ä–æ—Å—É
- Body - —Ö—Ä–∞–Ω–∏—Ç –≤ —Å–µ–±–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ payload –∑–∞–ø—Ä–æ—Å–∞

```XML
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
                  xmlns:ex="http://example.com/">
   <soapenv:Header/>
   <soapenv:Body>
      <ex:GetUserRequest>
         <ex:UserId>123</ex:UserId>
      </ex:GetUserRequest>
   </soapenv:Body>
</soapenv:Envelope>
```



---
## GraphQL
### –ß—Ç–æ —Ç–∞–∫–æ–µ GraphQL

GraphQL - —ç—Ç–æ —è–∑—ã–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –æ–±—â–µ–Ω–∏—è –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º. –û–Ω –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ RestAPI –ø–æ–ª–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –Ω—É–∂–Ω—ã—Ö –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞.

Apollo - —ç—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–¥–æ–±–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å GraphQL

![](_png/497e7040cd215fb0e69304ec4a2be9af.png)

GraphQL - —ç—Ç–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –æ–ø–∏—Å–∞—Ç—å —Å—Ö–µ–º—É –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –∏–∑ —ç—Ç–æ–π —Å—Ö–µ–º—ã –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–∞–Ω–Ω—ã–µ. 

–≠—Ç–æ –∫—Ä–∞–π–Ω–µ —É–¥–æ–±–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –ø—Ä–æ–¥—É–∫—Ç—É –Ω–∞–º –Ω—É–∂–Ω–∞—è –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏, –∞ –≤ –¥—Ä—É–≥–æ–º —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω–∞. 

–ï—Å–ª–∏ REST –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ö–µ–º—É –∏ —Ñ–æ—Ä–º–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞, —Ç–æ GQL –≥–æ–≤–æ—Ä–∏—Ç –æ–ø–∏—Å–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ö–µ–º—ã. 

### –í–∏–¥—ã –∑–∞–ø—Ä–æ—Å–æ–≤

–î–ª—è –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–∏—Å–∞—Ç—å:

- **Schema** - —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–≥—Ä—É–±–æ –≥–æ–≤–æ—Ä—è - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)
- **Query** - –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—ë—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

![](_png/f1a64170f997bfbccc077c80f2e5d671.png)

#### Query

Query (GET) - –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

- –æ–ø–∏—Å—ã–≤–∞–µ–º —Å—Ö–µ–º—É
- –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
- –ø–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –ø–æ —Å—Ö–µ–º–µ

```
# Schema
type Query { hero: Character}

# Request
{
  hero {
    name
  }
}

# Response
{
  "data": {
    "hero": {
      "name": "R2-D2"
    }
  }
}
```


##### Fragment

Fragments –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞–º –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ query –∏ —Å–æ–±—Ä–∞—Ç—å –∏–∑ –Ω–∏—Ö –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤ query

```GraphQL
query {
  leftComparison: hero(episode: EMPIRE) {
    ...comparisonFields
  }
  rightComparison: hero(episode: JEDI) {
    ...comparisonFields
  }
}

fragment comparisonFields on Character {
  name
  appearsIn
  friends {
    name
  }
}
```

–ò –æ—Ç–≤–µ—Ç –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º

```JSON
{
  "data": {
    "leftComparison": {
      "name": "Luke Skywalker",
      "appearsIn": [
        "NEWHOPE",
        "EMPIRE",
        "JEDI"
      ],
      "friends": [
        {
          "name": "Han Solo"
        },
        {
          "name": "Leia Organa"
        },
        {
          "name": "C-3PO"
        },
        {
          "name": "R2-D2"
        }
      ]
    },
    "rightComparison": {
      "name": "R2-D2",
      "appearsIn": [
        "NEWHOPE",
        "EMPIRE",
        "JEDI"
      ],
```

#### Mutation

**Mutation** —É–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞–∫–∏–µ-–ª–∏–±–æ –¥–∞–Ω–Ω—ã–µ –¥–æ–±–∞–≤–∏—Ç—å, –æ–±–Ω–æ–≤–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å (–∞–Ω–∞–ª–æ–≥ `post`/`put` –∑–∞–ø—Ä–æ—Å–æ–≤)

–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ —Ç—É—Ç –≤—ã–∑–≤–∞–Ω–∞ –º—É—Ç–∞—Ü–∏—è `updateHumanName`, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –º—ã:
- –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä `id` –∏ `name` –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
- –ø–æ —ç—Ç–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –º—ã –Ω–∞—Ö–æ–¥–∏–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏ –∏–∑–º–µ–Ω—è–µ–º –µ–≥–æ –∏–º—è
- –ø—Ä–æ—Å–∏–º –≤–µ—Ä–Ω—É—Ç—å –µ–≥–æ –Ω–æ–≤—ã–µ `id` –∏ `name` —ç—Ç–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

```
# Schema
type Mutation { updateHumanName(id: ID!, name: String!): Human}

# Request
## Operation
mutation UpdateHumanName($id: ID!, $name: String!) { 
  updateHumanName(id: $id, name: $name ) {
    id
    name
  }
}
## Vars
{
  "id": "1000",
  "name": "Luke Starkiller"
}

# Response
{
  "data": {
    "updateHumanName": {
      "id": "1000",
      "name": "Luke Starkiller"
    }
  }
}
```

#### Subscription

–ò —Ç—Ä–µ—Ç–∏–π –≤–∏–¥ –∑–∞–ø—Ä–æ—Å–æ–≤ - **Subscription** (–ø–æ–¥–ø–∏—Å–∫–∏) - –∫–ª–∏–µ–Ω—Ç —Å–ª—É—à–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

–≠—Ç–æ—Ç —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–≤–µ—Ä—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ WebSocket

```graphql
subscription StoryLikeSubscription($input: StoryLikeSubscribeInput) {
	storyLikeSubscribe(input: $input) {
		story {
			likers {
				count
			}
			likeSentence {
				text
			}
		}
	}
}
```

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –°–∞–º–æ–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç—É –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, –≥–¥–µ –æ–ø–∏—Å–∞–Ω—ã –≤—Å–µ –ø–æ–ª—è)
- –ö–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è (–º–æ–∂–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞ —Ç–∏–ø—ã –ø–æ GQL `npx apollo codegen:generate --localSchemaFile=grapql-schema.json --target=typescript`)
- –ö–ª–∏–µ–Ω—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- 

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

#### –°–µ—Ä–≤–µ—Ä

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
npm i express-graphql graphql
```

–î–∞–ª–µ–µ –Ω–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –æ–ø–∏—Å–∞—Ç—å —Å—Ö–µ–º—É –Ω–∞—à–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π:

- –ú—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—ä–µ–∫—Ç—ã User –∏ Post (—á–µ—Ä–µ–∑ `[Post]` —É–∫–∞–∑—ã–≤–∞–µ–º –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç –¥—Ä—É–≥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏)
- –û–ø–∏—Å—ã–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ –∏–Ω–ø—É—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–¥—É—Ç –∫ –Ω–∞–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä (—á–µ—Ä–µ–∑ `!` —É–∫–∞–∑—ã–≤–∞–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—è)
- –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º—É—Ç–∞—Ü–∏–∏ –∏ –∑–∞–ø—Ä–æ—Å—ã –≤ —Å—Ö–µ–º–µ

`schema.js`

```JS
const {buildSchema} = require('graphql')

const schema = buildSchema(`

    type User {
        id: ID
        username: String
        age: Int
        posts: [Post]
    }
    type Post {
        id: ID
        title: String
        content: String
    }

    input UserInput {
        id: ID
        username: String!
        age: Int!
        posts: [PostInput]
    }
    input PostInput {
        id: ID
        title: String!
        content: String!
    }

    type Query {
        getAllUsers: [User]
        getUser(id: ID): User
    }
    type Mutation {
        createUser(input: UserInput): User
    }

`)

module.exports = schema
```

–ó–∞—Ç–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —É –Ω–∞—Å –±—É–¥–µ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç —Å graphql

–í –Ω–µ–≥–æ –Ω–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å rootValue (–º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–ø–∏—Å–∞–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ GraphQL) –∏ –Ω–∞—à—É —Å—Ö–µ–º—É

`index.js`
```JS
const express = require('express')
const {graphqlHTTP} = require('express-graphql')
const cors = require('cors')
const schema = require('./schema')

const users = [{id: 1, username: "Vasya", age: 25}]

const app = express()
app.use(cors())

const createUser = (input) => {
    const id = Date.now()
    return {
        id, ...input
    }
}
const root = {
    getAllUsers: () => {
        return users
    },
    getUser: ({id}) => {
        return users.find(user => user.id == id)
    },
    createUser: ({input}) => {
        const user = createUser(input)
        users.push(user)
        return user
    }
}


app.use('/graphql', graphqlHTTP({
    graphiql: true,
    schema,
    rootValue: root
}))

app.listen(5000, () => console.log('server started on port 5000'))
```

#### –ö–ª–∏–µ–Ω—Ç

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≥—Ä–∞—Ñ –∏ –∫–ª–∏–µ–Ω—Ç –∞–ø–æ–ª–ª–æ –¥–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º

```bash
npm i graphql @apollo/client
```

–¢—É—Ç –º—ã —É–∂–µ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Apollo –∫–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Å graphql —Å–µ—Ä–≤–µ—Ä–æ–º, –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–≤–∞–π–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

`index.js`

```JS
import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';
import { ApolloProvider, ApolloClient, InMemoryCache } from '@apollo/client'

const client = new ApolloClient({
    uri: 'http://localhost:5000/graphql',
    cache: new InMemoryCache()
})

ReactDOM.render(
    <ApolloProvider client={client}>
        <App />
    </ApolloProvider>,
  document.getElementById('root')
);
```

–û–ø–∏—à–µ–º —Å—Ö–µ–º—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–∞–Ω–Ω—ã—Ö

`query / user.js`

```JS
import {gql} from '@apollo/client'

export const GET_ALL_USERS = gql`
    query {
        getAllUsers {
            id, username, age
        }
    }

`

export const GET_ONE_USER = gql`
    query getUser($id: ID){
        getUser(id: $id) {
            id, username
        }
    }

`
```

–û–ø–∏—à–µ–º —Å—Ö–µ–º—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

`mutations / user.js`

```JS
import {gql} from '@apollo/client'

export const CREATE_USER = gql`
    mutation createUser($input: UserInput) {
        createUser(input: $input) {
            id, username, age
        }
    }
`
```

–ò –¥–∞–ª–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–ª–∏–µ–Ω—Ç –Ω–∞ –Ω–∞—à–µ–º –≤–µ–±–µ

–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –º—ã –¥–æ–ª–∂–Ω—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ö—É–∫–∞–º–∏:

- useQuery, –≤ –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–µ—Ä–≤—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –ø–µ—Ä–µ–¥–∞—ë–º —Å—Ö–µ–º—É –∑–∞–ø—Ä–æ—Å–∞, –∞ –≤—Ç–æ—Ä—ã–º –ø—Ä–æ–ø—Å—ã
- useMutation, –≤ –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–µ—Ä–µ–¥–∞—ë–º –Ω–∞—à–∏ –º—É—Ç–∞—Ü–∏–∏ –∏ –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é-—Ç—Ä–∏–≥–≥–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

`App.js`

```JSX
import React, {useEffect, useState} from 'react';
import './App.css'
import {useMutation, useQuery} from "@apollo/client";
import {GET_ALL_USERS, GET_ONE_USER} from "./query/user";
import {CREATE_USER} from "./mutations/user";

const App = () => {
    const [users, setUsers] = useState([])
    const [username, setUsername] = useState('')
    const [age, setAge] = useState(0)

    const {data, loading, error, refetch} = useQuery(GET_ALL_USERS)
    const {data:oneUser, loading: loadingOneUser} = useQuery(GET_ONE_USER, {
        variables: {
            id: 1
        }
    })
    const [newUser] = useMutation(CREATE_USER)

    console.log(oneUser)

    useEffect(() => {
        if (!loading) {
            setUsers(data.getAllUsers)
        }
    }, [data])

    const addUser = (e) => {
        e.preventDefault()
        newUser({
            variables: {
                input: {
                    username, age
                }
            }
        }).then(({data}) => {
            console.log(data)
            setUsername('')
            setAge(0)
        })
    }
    const getAll = e => {
        e.preventDefault()
        refetch()
    }

    if (loading) {
        return <h1>Loading...</h1>
    }

    return (
        <div>
            <form>
                <input value={username} onChange={e => setUsername(e.target.value)} type="text"/>
                <input value={age} onChange={e => setAge(e.target.value)} type="number"/>
                <div className="btns">
                    <button onClick={(e) => addUser(e)}>–°–æ–∑–¥–∞—Ç—å</button>
                    <button onClick={e => getAll(e)}>–ü–æ–ª—É—á–∏—Ç—å</button>
                </div>
            </form>
            <div>
                {users.map(user =>
                    <div className="user">{user.id}. {user.username} {user.age}</div>
                )}
            </div>
        </div>
    );
};

export default App;
```


---
## WebSockets

WebSockets - —ç—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é (–¥—É–ø–ª–µ–∫—Å–Ω—É—é) —Å–≤—è–∑—å –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏

–≠—Ç–æ —Å–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –∏ real-time –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: 
- —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤–∏–¥–µ–æ (twitch)
- –≤ —á–∞—Ç–∞—Ö
- –Ω–∞ —Ö–æ–ª—Å—Ç–∞—Ö —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (miro, figma)
- –≤ –Ω–æ–≤–æ—Å—Ç—è—Ö
- –Ω–∞ –±–∏—Ä–∂–∞—Ö —Å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∞–∫—Ü–∏–π

–ò —É –Ω–∞—Å –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ real-time –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫—Ä–æ–º–µ WS

### Long polling

–≠—Ç–æ —Å–ø–æ—Å–æ–±, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –º—ã —Å –∫–ª–∏–µ–Ω—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤–∏—Å–∏—Ç —Ä–æ–≤–Ω–æ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—Ç–∏—Ç –Ω–∞ –Ω–µ–≥–æ. –ï—Å–ª–∏ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å, —Ç–æ –º—ã —Å –∫–ª–∏–µ–Ω—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∑–∞–Ω–æ–≤–æ.

–ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞–º —á—Ç–æ-–Ω–∏–±—É–¥—å –≤–µ—Ä–Ω—ë—Ç, —Ç–æ –º—ã –æ–ø—è—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞.

–≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç –Ω–∞—Å –ø—Ä–æ—Å—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

![](_png/1c29e93fa411c5c70b04f773a25aeb33.png)

–¢—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç get-–∑–∞–ø—Ä–æ—Å, –Ω–æ –º—ã –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–º—É –æ—Ç–≤–µ—Ç (–æ—Ç–≤–µ—Ç –º—ã –∑–∞–±–∏–Ω–¥–∏–ª–∏ –≤ —Å–æ–±—ã—Ç–∏–µ). –í–∑–∞–º–µ–Ω –º—ã –∂–¥—ë–º, –∫–æ–≥–¥–∞ –¥—Ä—É–≥–æ–π —É—á–∞—Å—Ç–Ω–∏–∫ —á–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —É–∂–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏–µ –≤ get-–∑–∞–ø—Ä–æ—Å–µ –≤—ã–∑—ã–≤–∞–µ–º, –ø–æ—Å–ª–µ —á–µ–≥–æ –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —á–∞—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –º—ã –∏–º–µ–µ–º:

- –ø–æ—Å—Ç-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –≤–Ω—É—Ç—Ä–∏ –≥–µ—Ç-–∑–∞–ø—Ä–æ—Å–∞
- –≥–µ—Ç-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –≤ —Å–µ–±–µ –∏–≤–µ–Ω—Ç, —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–π, –∫–æ–≥–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –∑–∞–ø—Ä–æ—Å —Å –¥–∞–Ω–Ω—ã–º–∏

```JS
const express = require('express');
const cors = require('cors');
const events = require('events');
const PORT = 5000;

// –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —ç–º–∏—Ç—Ç–µ—Ä —Å–æ–±—ã—Ç–∏–π
const emitter = new events.EventEmitter();

const app = express();

app.use(cors());
app.use(express.json());

// –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—à–µ–Ω–∏—è
app.get('/get-messages', (req, res) => {
	// –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ, —Ç–æ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–∞—Ç–∞ –Ω—É–∂–Ω–æ –æ—Å–≤–µ–¥–æ–º–∏—Ç—å –æ –¥–æ—Å—Ç–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è
	emitter.once('newMessage', (message) => {
		// –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, —É –∫–æ–≥–æ –≤–∏—Å–∏—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
		res.json(message);
	});
});

// –±—É–¥–µ—Ç
app.post('/new-messages', (req, res) => {
	const message = req.body;
	// —Ç—É—Ç –º—ã –≤—ã–≤–∑–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –∏–∑ get, –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
	emitter.emit('newMessage', message);
	res.status(200);
});

// –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ–º –ø–æ—Ä—Ç
app.listen(PORT, () => console.log(`server started on PORT ${PORT}`));
```

–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö `subscribe()` –∏ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ `sendMessage()`. –£–∂–µ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ë—Ç—Å—è –≥–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –æ—Ç–¥–∞—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

```JSX
import React, { useEffect, useState } from 'react';
import './styles.css';
import axios from 'axios';

const LongPulling = () => {
	const [messages, setMessages] = useState([]);
	const [value, setValue] = useState('');

	useEffect(() => {
		subscribe();
	}, []);

	const subscribe = async () => {
		try {
			// —Ç—É—Ç –º—ã –ø–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å–≤—è–∑—å –ø—Ä–æ–ø–∞–¥–∞–µ—Ç
			const { data } = await axios.get('http://localhost:5000/get-messages');
			setMessages((prev) => [data, ...prev]);
			// —Ç—É—Ç –º—ã –ø–µ—Ä–µ–æ—Ñ–æ—Ä–º–ª—è–µ–º –ø–æ–¥–ø–∏—Å–∫—É, —á—Ç–æ–±—ã —Å–≤—è–∑—å –Ω–µ –ø—Ä–æ–ø–∞–¥–∞–ª–∞
			await subscribe();
		} catch (e) {
			// –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –æ—à–∏–±–∫–∞, —Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
			setTimeout(() => {
				subscribe();
			}, 500);
		}
	};

	const sendMessage = async () => {
		await axios.post('http://localhost:5000/new-messages', {
			message: value,
			id: Date.now(),
		});
	};

	return (
		<div>
			<div>
				<h2>LongPulling</h2>

				<div className='form'>
					<input value={value} onChange={(e) => setValue(e.target.value)} type='text' />
					<button onClick={sendMessage}>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
				</div>
				<div className='messages'>
					{messages.map((mess) => (
						<div className='message' key={mess.id}>
							{mess.message}
						</div>
					))}
				</div>
			</div>
		</div>
	);
};

export default LongPulling;
```

–ò —Ç–µ–ø–µ—Ä—å –≤ –¥–≤—É—Ö —Ä–∞–∑–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö –º—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ —á–∞—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

![](_png/de5fd262174dab5eeb6000a2887408b9.png)

### event soursing (server sent events)

–í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–Ω–∞—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è - —ç—Ç–æ event soursing, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –ø–æ–¥ —Å–æ–±–æ–π, —á—Ç–æ–±—ã –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É.

–ö–ª–∏–µ–Ω—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –±–æ–ª—å—à–µ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

–°—Ç—Ä–æ–∏—Ç—Å—è –¥–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –Ω–∞ –±–∞–∑–µ –æ–±—ã—á–Ω–æ–≥–æ https

![](_png/9be9f29384dbe518965ed25c618e6709.png)

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –º—ã —Å–æ–∑–¥–∞—ë–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª–∏—Ç, —á—Ç–æ –Ω–∞—à–∏ –∑–∞–ø—Ä–æ—Å—ã –∏–º–µ—é—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ —Å–æ–∑–¥–∞—ë–º –º–Ω–æ–≥–æ–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∏–≤–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –æ—Ç–≤–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º

```JS
const express = require('express');
const cors = require('cors');
const events = require('events');
const PORT = 5000;

const emitter = new events.EventEmitter();

const app = express();

app.use(cors());
app.use(express.json());

app.get('/connect', (req, res) => {
	// —Ç—É—Ç –º—ã –∑–∞–¥–∞—ë–º –∑–∞–≥–æ–ª–æ–≤–æ–∫, —á—Ç–æ —Å–≤—è–∑—å —É –Ω–∞—Å –±—É–¥–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è
	res.writeHead(200, {
		Connection: 'keep-alive',
		'Content-Type': 'text/event-stream',
		'Cache-Control': 'no-cache',
	});

	// —ç—Ç–æ—Ç –∂–µ –∏–≤–µ–Ω—Ç –º–æ–∂–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑, –ø–æ—ç—Ç–æ–º—É –º–µ–Ω—è–µ–º once –Ω–∞ on
	emitter.on('newMessage', (message) => {
		// —Ç—É—Ç –º—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –≤ —Ç–∞–∫–æ–π —à–∞–±–ª–æ–Ω, —á—Ç–æ–±—ã –æ–Ω–∞ –ø—Ä–∏–Ω—è–ª–∞—Å—å –∫–ª–∞—Å—Å–æ–º EventSource
		res.write(`data: ${JSON.stringify(message)} \n\n`);
	});
});

app.post('/new-messages', (req, res) => {
	const message = req.body;
	emitter.emit('newMessage', message);
	res.status(200);
});

app.listen(PORT, () => console.log(`server started on PORT ${PORT}`));
```

–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ –Ω—É–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `subscribe()`, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫–ª–∞—Å—Å–æ–º `EventSource`, –∫–æ—Ç–æ—Ä—ã–π, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, —É–∂–µ –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

```JSX
import React, { useEffect, useState } from 'react';
import './styles.css';
import axios from 'axios';

const EventSourcing = () => {
	const [messages, setMessages] = useState([]);
	const [value, setValue] = useState('');

	useEffect(() => {
		subscribe();
	}, []);

	const subscribe = async () => {
		// —Å–æ–∑–¥–∞—ë–º –∏–≤–µ–Ω—Ç—Å—É—Ä—Å —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∫–æ–Ω–Ω–µ–∫—à–Ω-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
		const eventSource = new EventSource(`http://localhost:5000/connect`);

		// —Ç—É—Ç –º—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
		eventSource.onmessage = function (event) {
			const message = JSON.parse(event.data);
			setMessages((prev) => [message, ...prev]);
		};
	};

	const sendMessage = async () => {
		await axios.post('http://localhost:5000/new-messages', {
			message: value,
			id: Date.now(),
		});
	};

	return (
		<div>
			<div>
				<h2>EventSourcing</h2>

				<div className='form'>
					<input value={value} onChange={(e) => setValue(e.target.value)} type='text' />
					<button onClick={sendMessage}>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
				</div>
				<div className='messages'>
					{messages.map((mess) => (
						<div className='message' key={mess.id}>
							{mess.message}
						</div>
					))}
				</div>
			</div>
		</div>
	);
};

export default EventSourcing;
```

–ò –Ω–∞—à —á–∞—Ç –≤—Å—ë —Ç–∞–∫ –∂–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ —Ç–µ–ø–µ—Ä—å –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –ø–µ—Ä–µ–¥–∞—á–∏ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

![](_png/2b5bb85e4552a0b103a3545e13b5b67f.png)

### WebSockets

–≠—Ç–æ —Å–∞–º—ã–π –º–æ—â–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º –∏ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–Ω—è—Ç–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –≤–µ–±—Å–æ–∫–µ—Ç-—Å–µ—Ä–≤–µ—Ä–∞

![](_png/6f86f10b26979c8b8d855f7f0d5b6bc8.png)

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–¥–Ω—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –≤–µ–±—Å–æ–∫–µ—Ç–æ–≤

–î–∞–ª–µ–µ –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ–∫–µ—Ç—ã.

WebSocket —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–ª—è –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞ –æ–¥–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —Å–∞–º–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –ß—Ç–æ–±—ã –æ–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å —Å—Ä–∞–∑—É –æ–±–æ–∏–º –ª—é–¥—è–º –≤ —á–∞—Ç–µ, –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å `broadcastMessage()`.

```JS
const ws = require('ws');

// –∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –≤–µ–±—Å–æ–∫–µ—Ç–æ–≤
const wss = new ws.Server(
	{
		port: 5000,
	},
	() => console.log(`Server started on 5000`)
);

// –ø—Ä–∏ –ø–æ–¥–ª—é—á–µ–Ω–∏–∏ —Å–æ–∫–µ—Ç–∞
wss.on('connection', function connection(ws) {
	// –ø—Ä–∏ –æ—Ç–ø—Ä–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è
	ws.on('message', function (message) {
		// –º—ã –ø–æ–ª—É—á–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∏–µ–Ω—Ç–∞
		message = JSON.parse(message);

		// –∏ –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ (–µ—Å—Ç—å —Å–æ–±—ã—Ç–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è), –±—É–¥–µ–º –≤—ã–ø–æ–ª–Ω—è—Ç—å "—Ä–∞–∑–Ω—ã–µ" –¥–µ–π—Å—Ç–≤–∏—è
		switch (message.event) {
			case 'message':
				broadcastMessage(message);
				break;
			case 'connection':
				broadcastMessage(message);
				break;
		}
	});
});

// —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
function broadcastMessage(message, id) {
	// –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
	wss.clients.forEach((client) => {
		// –∫–∞–∂–¥—ã–π –∫–ª–∏–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –≤–µ–±—Å–æ–∫–µ—Ç–æ–º –∏ –º–æ–∂–Ω–æ –∫–∞–∂–¥–æ–º—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
		client.send(JSON.stringify(message));
	});
}
```

–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ –Ω—É–∂–Ω–æ —É–∂–µ –±—É–¥–µ—Ç –æ–ø–∏—Å–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–æ–∫–µ—Ç–∞–º –∏ –æ–ø–∏—Å–∞—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ —Å–æ–∫–µ—Ç–∞ –Ω–∞ –µ–≥–æ —Ä–∞–∑–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–æ—à–∏–±–∫–∞, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ)

```JSX
import React, { useEffect, useRef, useState } from 'react';
import axios from 'axios';

const WebSock = () => {
	const [messages, setMessages] = useState([]);
	const [value, setValue] = useState('');
	const [connected, setConnected] = useState(false);
	const [username, setUsername] = useState('');

	// —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å —Å–æ–∫–µ—Ç –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ, –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –µ–≥–æ –≤ —Ä–µ—Ñ
	const socket = useRef();

	function connect() {
		// –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º —Å—é–¥–∞ —Å–æ–∫–µ—Ç
		socket.current = new WebSocket('ws://localhost:5000');

		// –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å–æ–∫–µ—Ç–∞
		socket.current.onopen = () => {
			setConnected(true);

			// —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —Å–æ–∫–µ—Ç–∞–º
			const message = {
				event: 'connection',
				username,
				id: Date.now(),
			};

			// –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
			socket.current.send(JSON.stringify(message));

			console.log('Socket –ø–æ–¥–∫–ª—é—á–µ–Ω');
		};

		// –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–æ–∫–µ—Ç–∞
		socket.current.onmessage = (event) => {
			const message = JSON.parse(event.data);
			setMessages((prev) => [message, ...prev]);
		};

		// –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–æ–∫–µ—Ç–∞
		socket.current.onclose = () => {
			console.log('Socket –∑–∞–∫—Ä—ã—Ç');
		};

		// –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤ —Å–æ–∫–µ—Ç–µ
		socket.current.onerror = () => {
			console.log('Socket –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞');
		};
	}

	const sendMessage = async () => {
		const message = {
			username,
			message: value,
			id: Date.now(),
			event: 'message',
		};
		socket.current.send(JSON.stringify(message));
		setValue('');
	};

	if (!connected) {
		return (
			<div className='center'>
				<div className='form'>
					<input
						value={username}
						onChange={(e) => setUsername(e.target.value)}
						type='text'
						placeholder='–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è'
					/>
					<button onClick={connect}>–í–æ–π—Ç–∏</button>
				</div>
			</div>
		);
	}

	return (
		<div className='center'>
			<div>
				<div className='form'>
					<input value={value} onChange={(e) => setValue(e.target.value)} type='text' />
					<button onClick={sendMessage}>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
				</div>
				<div className='messages'>
					{messages.map((mess) => (
						<div key={mess.id}>
							{mess.event === 'connection' ? (
								<div className='connection_message'>
									–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {mess.username} –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è
								</div>
							) : (
								<div className='message'>
									{mess.username}. {mess.message}
								</div>
							)}
						</div>
					))}
				</div>
			</div>
		</div>
	);
};

export default WebSock;
```

![](_png/892690c344887e3c22bc9b443b8e6c7b.png)



---
## RPC (gRPC, tRPC)

RPC - remote produce call - —ç—Ç–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–ª–∏–∑—É–µ—Ç—Å—è –∫–∞–∫ —É–¥–∞–ª—ë–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –±—ç–∫—ç–Ω–¥–µ

–í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, –º—ã –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –≤—ã–∑—ã–≤–∞–µ–º –Ω–µ –∑–∞–ø—Ä–æ—Å—ã, –∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –±—ç–∫—ç–Ω–¥–µ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –æ–±—ä–µ–∫—Ç `stub` 

![](../_png/Pasted%20image%2020250927120526.png)

### Protobuf

–≠—Ç–æ —Å—Ç—Ä–æ–≥–æ—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —è–∑—ã–∫ –∏ —Ñ–æ—Ä–º–∞—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∞ –∫–ª–∏–µ–Ω—Ç—É –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –∏—Ö

–û—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ–º –¥–∞–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ —è–≤–ª—è–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤ –ø–æ —Å–µ—Ç–∏

–°—Ö–µ–º–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.proto` –∏ –ø—Ä–æ–≥–æ–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä `protoc` —Å –¥–∞–ª—å–Ω–µ–π—à–∏–º –ø–µ—Ä–µ–≤–æ–¥–æ–º –≤ –ª—é–±–æ–π –Ω—É–∂–Ω—ã–π –Ω–∞–º —è–∑—ã–∫

```proto
message User {
  int32 id = 1;
  string name = 2;
}
```

![](../_png/Pasted%20image%2020250927145805.png)

### gRPC

gRPC - —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –æ—Ç Google

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ gRPC:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç HTTP2 –≤–º–µ—Å—Ç–æ HTTP1/1
- –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–∞–∑—ã –±—ã—Å—Ç—Ä–µ–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–Ω–∞—Ä–Ω—É—é –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö (protobuf) –¥–ª—è –±–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ–≥–æ —Å–∂–∞—Ç–∏—è –¥–∞–Ω–Ω—ã—Ö
- —É–¥–æ–±–Ω—ã–π –≤—ã–∑–æ–≤ –ø—Ä–æ—Ü–µ–¥—É—Ä
- –ø—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π —Å—Ç—Ä–∏–º–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö
- –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ –∫–æ—Ä–æ–±–∫–∏ 
	- –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞
	- –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
	- –ø–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–º–µ—Ä –æ–ø–∏—Å–∞–Ω–Ω–æ–≥–æ proto

```proto
syntax = "proto3";

option java_multiple_files = true;
option java_package = "io.grpc.examples.helloworld";
option java_outer_classname = "HelloWorldProto";
option objc_class_prefix = "HLW";

package helloworld;

// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Greeter —Å–µ—Ä–≤–∏—Å–∞
service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply) {}

  rpc SayHelloStreamReply (HelloRequest) returns (stream HelloReply) {}
}

// –ó–∞–ø—Ä–æ—Å —Å –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
message HelloRequest {
  string name = 1;
}

// –°–æ–æ–±—â–µ–Ω–∏–µ —Å –æ—Ç–≤–µ—Ç–æ–º
message HelloReply {
  string message = 1;
}
```

–ü—Ä–∏–º–µ—Ä —Å–µ—Ä–≤–µ—Ä–∞

```JS
var PROTO_PATH = __dirname + '/../../protos/helloworld.proto';

var grpc = require('@grpc/grpc-js');
var protoLoader = require('@grpc/proto-loader');
var packageDefinition = protoLoader.loadSync(
    PROTO_PATH,
    {
	    keepCase: true,
	    longs: String,
	    enums: String,
	    defaults: true,
	    oneofs: true
    }
);
    
var hello_proto = grpc.loadPackageDefinition(packageDefinition).helloworld;

// –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è 
function sayHello(call, callback) {
  callback(null, {message: 'Hello ' + call.request.name});
}

// –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã Greeter —Å–µ—Ä–≤–∏—Å–∞ 
function main() {
  var server = new grpc.Server();
  server.addService(hello_proto.Greeter.service, {sayHello: sayHello});
  server.bindAsync(
	'0.0.0.0:50051', 
	grpc.ServerCredentials.createInsecure(), 
	(err, port) => {
		if (err != null) {
		  return console.error(err);
		}
		console.log(`gRPC listening on ${port}`)
	}
  );
}

main();
```

–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Å—Ç–æ—Ä–æ–Ω–∞

```TS
var PROTO_PATH = __dirname + '/../../protos/helloworld.proto';

var parseArgs = require('minimist');
var grpc = require('@grpc/grpc-js');
var protoLoader = require('@grpc/proto-loader');

var packageDefinition = protoLoader.loadSync(
    PROTO_PATH,
    {keepCase: true,
     longs: String,
     enums: String,
     defaults: true,
     oneofs: true
    });
var hello_proto = grpc.loadPackageDefinition(packageDefinition).helloworld;

function main() {
  var argv = parseArgs(process.argv.slice(2), {
    string: 'target'
  });
  var target;
  if (argv.target) {
    target = argv.target;
  } else {
    target = 'localhost:50051';
  }
  var client = new hello_proto.Greeter(target,
                                       grpc.credentials.createInsecure());
  var user;
  if (argv._.length > 0) {
    user = argv._[0];
  } else {
    user = 'world';
  }
  client.sayHello({name: user}, function(err, response) {
    console.log('Greeting:', response.message);
  });
}

main();
```

### tRPC

tRPC - typesafety RPC - –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ RPC, –∫–æ—Ç–æ—Ä–æ–µ –∏–º–µ–µ—Ç —É–¥–æ–±–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è TS

#### –°–µ—Ä–≤–µ—Ä

–°–µ—Ä–≤–µ—Ä `express` + `tRPC`:

`server.ts`
```TS
import express from "express";
import { inferAsyncReturnType, initTRPC } from "@trpc/server";
import * as trpcExpress from "@trpc/server/adapters/express";
import cors from "cors";

// –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –æ–ø—Ü–∏–∏ Express
const createContext = ({ req, res }: trpcExpress.CreateExpressContextOptions) => ({});
type Context = inferAsyncReturnType<typeof createContext>;

// –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
const t = initTRPC.context<Context>().create();

// –†–æ—É—Ç–µ—Ä —Å –º–µ—Ç–æ–¥–∞–º–∏
const appRouter = t.router({
  // –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  getUser: t.procedure
    .input((val: unknown) => {
      if (typeof val === "number") return val;
      throw new Error("Invalid input");
    })
    .query(({ input }) => {
      return { id: input, name: "Valery" };
    }),

  // –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  add: t.procedure
    .input((val: unknown) => {
      if (typeof val === "object" && val && "a" in val && "b" in val) {
        return val as { a: number; b: number };
      }
      throw new Error("Invalid input");
    })
    .mutation(({ input }) => {
      return { sum: input.a + input.b };
    }),
});

// —Ç–∏–ø —Ä–æ—É—Ç–µ—Ä–∞
export type AppRouter = typeof appRouter;

const app = express();
app.use(cors());

// –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ tRPC middleware —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º /trpc
app.use(
  "/trpc",
  trpcExpress.createExpressMiddleware({
    router: appRouter,
    createContext,
  }),
);

// –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
app.listen(4000, () => {
  console.log("üöÄ tRPC server running on http://localhost:4000/trpc");
});
```

#### –ö–ª–∏–µ–Ω—Ç

–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏ –∫–ª–∏–µ–Ω—Ç tRPC –∏ –æ–ø–∏—Å–∞—Ç—å —Ç–∏–ø—ã –µ–≥–æ –º–µ—Ç–æ–¥–æ–≤. –¢—É—Ç –º–µ—Ç–æ–¥—ã –º—ã —Å—Ç—è–Ω–µ–º –Ω–∞–ø—Ä—è–º—É—é —Å —Å–µ—Ä–≤–µ—Ä–∞.

`client.ts`
```TS
import { createTRPCProxyClient, httpBatchLink } from "@trpc/client";
import type { AppRouter } from "../server"; // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–∏–ø—ã —Å —Å–µ—Ä–≤–µ—Ä–∞

export const trpc = createTRPCProxyClient<AppRouter>({
  links: [
    httpBatchLink({
      url: "http://localhost:4000/trpc",
    }),
  ],
});
```

–ò –¥–∞–ª–µ–µ –º—ã —É–∂–µ —Å–º–æ–∂–µ–º –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä—è–º–æ –≤ `useEffect` 

`App.tsx`
```TSX
import { useEffect, useState } from "react";
import { trpc } from "./client";

function App() {
  const [user, setUser] = useState<{ id: number; name: string } | null>(null);
  const [sum, setSum] = useState<number | null>(null);

  useEffect(() => {
    // –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
    // –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ query
    trpc.getUser.query(123).then((res) => setUser(res));

    // –ü—Ä–∏–º–µ—Ä –º—É—Ç–∞—Ü–∏–∏
    // –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ mutate
    trpc.add.mutate({ a: 5, b: 7 }).then((res) => setSum(res.sum));
  }, []);

  return (
    <div style={{ padding: 20 }}>
      <h1>tRPC React + Express Example</h1>

      {user && (
        <p>
          üë§ User: {user.name} (id: {user.id})
        </p>
      )}

      {sum !== null && <p>‚ûï Sum: {sum}</p>}
    </div>
  );
}

export default App;
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞

```bash
npm install @trpc/client @trpc/react-query @tanstack/react-query
```

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è tRPC –¥–ª—è React

`trpc.ts`
```TS
import { createTRPCReact } from "@trpc/react-query";
import type { AppRouter } from "../server"; // –∏–º–ø–æ—Ä—Ç —Ç–∏–ø–æ–≤ —Å –±—ç–∫–µ–Ω–¥–∞

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è React-—Ö—É–∫–æ–≤
export const trpc = createTRPCReact<AppRouter>();
```

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞

`client.ts`
```TS
import { httpBatchLink } from "@trpc/client";
import { trpc } from "./trpc";

export const trpcClient = trpc.createClient({
  links: [
    httpBatchLink({
      url: "http://localhost:4000/trpc", // backend URL
    }),
  ],
});
```

–û–±—ë—Ä—Ç–∫–∏

`main.tsx`
```TSX
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";
import { trpc, trpcClient } from "./client";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";

const queryClient = new QueryClient();

ReactDOM.createRoot(document.getElementById("root")!).render(
  <trpc.Provider client={trpcClient} queryClient={queryClient}>
    <QueryClientProvider client={queryClient}>
      <App />
    </QueryClientProvider>
  </trpc.Provider>
);
```

–ú—É—Ç–∞—Ü–∏–∏ —Å –∏–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ö—É–∫–æ–≤

`App.tsx`
```TSX
import { trpc } from "./trpc";

function App() {
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
  const { data: user, isLoading: userLoading, error: userError } = trpc.getUser.useQuery(123);

  // –ú—É—Ç–∞—Ü–∏—è —Å invalidate cache
  const utils = trpc.useUtils();
  const addMutation = trpc.add.useMutation({
    onSuccess: () => {
      utils.invalidate(); // –ø–µ—Ä–µ–∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –Ω–∞–¥–æ
    },
  });

  return (
    <div style={{ padding: 20 }}>
      <h1>tRPC React + Express Example</h1>

      {userLoading && <p>–ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</p>}
      {userError && <p>–û—à–∏–±–∫–∞: {userError.message}</p>}
      {user && <p>üë§ {user.name} (id: {user.id})</p>}

      <button onClick={() => addMutation.mutate({ a: 5, b: 7 })}>
        –°–ª–æ–∂–∏—Ç—å 5 + 7
      </button>

      {addMutation.isLoading && <p>–°—á–∏—Ç–∞–µ–º...</p>}
      {addMutation.data && <p>‚ûï –†–µ–∑—É–ª—å—Ç–∞—Ç: {addMutation.data.sum}</p>}
    </div>
  );
}

export default App;
```
