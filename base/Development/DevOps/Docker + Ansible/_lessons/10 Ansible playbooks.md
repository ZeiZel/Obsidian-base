
## Playbook

Ansible Playbook - это описание конфигурации, оркестрации или вкладки. Оно описывает состояние удалённой системы или шаги отдельного процесса.

Это самодокументируемая последовательность операций, которая описана в скрипте. Она сохраняется на компьютере и может повторяться из раза в раз на всех связанных устройствах.

- name - имя плейбука
- hosts - машины, на которых должны будут выполниться команды
- tasks - это набор ad-hoc команд. В них передаются те же самые параметры, что и в обычные команды ansible.

![](_png/Pasted%20image%2020250111142409.png)

Немного поменяем конфигурацию, чтобы он попытался выполнить операцию на локалке

`hosts.ini`
```ini
[demo]
127.0.0.1 ansible_user=zeizel ansible_connection=local
```

А далее напишем скрипт playbook

- name - это имя выполняемой операции
- user - это модуль, который подтянется для выполнения команды

`user.yml`
```YML
---
- name: user
  hosts: demo
  tasks:
    - name: create user
      user:
        name: zeizel
        state: present
	  become: true # предоставит возможность запросить sudo пароль
```

И далее запускаем `ansible-playbook` команду. Добавляем `-K`, чтобы в случае чего запросить `sudo` пароль

```bash
$ ansible-playbook -i hosts.ini user.yml -K

PLAY [user] **********************************************************************************************

TASK [Gathering Facts] ***********************************************************************************
ok: [127.0.0.1]

TASK [create user] ***************************************************************************************
ok: [127.0.0.1]

PLAY RECAP ***********************************************************************************************
127.0.0.1                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

## Переменные


## Отладка



## Блоки и отработка ошибок



## Асинхронные задачи



## Упражнение - Настройка сервера



## Ansible Lint







