
## Устанавливаем RabbitMQ

Поднимаем композ с нужным образом

`docker-compose.yml`
```YML
services:
	rmq:
		image: rabbitmq:3-management
		restart: always
		ports:
			- "15672:15672" # админка
			- "5672:5672" # отправка сообщений
```

И, без заданных переменными пароля и логина, вводим для авторизации везде `guest`

## Устройство RabbitMQ

Наши микросервисы в схеме работы RMQ будут делиться на:
- Publisher -  публикует сообщения (отправитель)
- Subscriber - тот, кто подписывается на получение сообщений (получатель). Он достаёт сообщения из очереди.
- Queue - очередь (почтовый ящик). Сюда перенаправляются сообщения. 
- Exchange - обменный ящик (почтовое отделение). Решает, как доставить сообщение адресату и получает все сообщения.

- Routing Key - маршрут передачи сообщения. Это ключ, который указывает, куда отправить сообщение
- Binding - связь очереди с маршрутом. Помогает Exchange понимать, по какому Routing Key в какоую Queue нужно отправлять сообщение.
- Channel - канал передачи/приёма сообщения.
- Connection - соединение клиента RMQ

![](_png/Pasted%20image%2020250120183234.png)

Тут у нас отображены все connections к нашему RMQ из всех сервисов. 

Мы можем развернуть несколько инстансов RMQ и объединить их в кластер, чтобы поднять отказоустойчивость.

![](_png/Pasted%20image%2020250124181517.png)

Все каналы для передачи сообщений

![](_png/Pasted%20image%2020250124184402.png)

Тут отображены дефолтные очереди

![](_png/Pasted%20image%2020250124184924.png)

Отображение, создание и управление очередьми

![](_png/Pasted%20image%2020250124184956.png)

Создаём директовый Exchange с произвольным именем, который будет определять тип нашего сообщения.

![](_png/Pasted%20image%2020250124185133.png)

Далее создаём очередь, которая будет классического типа (quorum - это более персистентная, а stream - поток), durable (сохраняется после падения) и не auto delete (не будет удаляться при отключении всех пользователей).

![](_png/Pasted%20image%2020250124185359.png)

Теперь нам нужно подключить Exchange к созданной череди через биндинг. По ключу my-key, exchange будет класть сообщения в очередь my-queue

![](_png/Pasted%20image%2020250124185950.png)

В самой очереди тоже появилась связь с передатчиком

![](_png/Pasted%20image%2020250124190136.png)



![](_png/Pasted%20image%2020250124185034.png)




## Типы exchange









## Администрирование RabbitMQ









## Код - Простой обмен сообщении_1









## Код - Реализация запрос - ответ













