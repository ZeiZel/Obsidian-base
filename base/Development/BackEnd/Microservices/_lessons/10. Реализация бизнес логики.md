

## Бизнес логика и события

Если монолите мы можем воспользоваться layer, гексогональной и другими архитектурами, то в МС нам нужно реализовыать её иначе. Тут мы должны переходить на Event Sourcing и доменные события. 

Верхний слой сервиса:
- Event Handler - обрабатывает доменные события
- Command Handler - обрабатывает команды, изменяющие данные
- Query Handler - обработка запроса данных

Средний слой:
- Core Service - ключевой сервис бизнес-логики. С ним работает весь верхний слой. Сам он работает с публикацией ивентов (и уведомляет об изменении состояния) и моделью сущности. 
- Event Publisher - отправка ивентов

Нижний слой: 
- Entity Model - явялется представлением данных и кладётся в репозиторий
- Repository - получает данные и отправляет энтити в БД

База данных - конечная точка

![](_png/Pasted%20image%2020250129204434.png)

У нас есть два подхода при работе с данными:
1. Использовать только Controller. Он будет в себя принимать ивенты, хэндлеры, запросы, а потом только получать какие-то данные
2. Event Handler + Command Handler + Query Handler. Использовать вместе разные хэндлеры для отдельных запросов в сервис.

3:21

![](_png/Pasted%20image%2020250130185153.png)









## Доработка архитектуры Accounts









## Код Структурируем сервис Accounts









## Упражнение Реализуем Commands









